# Security monitoring and default deny policies
---
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  name: default-deny-ingress
  namespace: production
spec:
  endpointSelector: {}
  ingress:
    - fromEndpoints:
        - matchLabels:
            k8s:io.kubernetes.pod.namespace: production
---
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  name: audit-egress
  namespace: production
spec:
  endpointSelector:
    matchLabels:
      security.policy/audit: "true"
  egress:
    - toFQDNs:
        - matchName: "allowed-api.example.com"
    - toEntities:
        - kube-apiserver
---
# Monitoring and alerting policy
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy
metadata:
  name: monitoring-access
  namespace: kube-system
spec:
  endpointSelector:
    matchLabels:
      app: monitoring
  ingress:
    - fromEndpoints:
        - matchLabels:
            app: prometheus
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
